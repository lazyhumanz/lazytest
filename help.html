<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Help | QMS</title>
<meta name="description" content="Help and Support - Keyboard Shortcuts and Bug Reports">
<link rel="icon" type="image/svg+xml" href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMjRweCIgdmlld0JveD0iMCAtOTYwIDk2MCA5NjAiIHdpZHRoPSIyNHB4IiBmaWxsPSIjMWY5ZTRiIj48cGF0aCBkPSJNMjAwLTEyMHEtMzMgMC01Ni41LTIzLjVUMTIwLTIwMHYtNTYwcTAtMzMgMjMuNS01Ni41VDIwMC04NDBoNTYwcTMzIDAgNTYuNSAyMy41VDg0MC03NjB2NTYwcTAgMzMtMjMuNSA1Ni41VDc2MC0xMjBIMjAwWm00OTEtODBoNjl2LTY5bC02OSA2OVptLTQ1NyAwaDczbDEyMC0xMjBoODVMNDUyLTIwMGg2NGwxMjAtMTIwaDg1TDU0MS0yMDBoNjVsMTIwLTEyMGgzNHYtNDQwSDIwMHY1MDlsNjktNjloODVMNDM0LTIwMFptNzItMjAwLTU2LTU2IDE3Ny0xNzcgODAgODAgMTQ3LTE0NyA1NiA1Ni0yMDMgMjA0LTgwLTgwLTEyMSAxMjBaIi8+PC9zdmc+">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="theme.css">
    <link rel="stylesheet" href="sidebar.css">
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="env-config.js"></script>
    <script src="supabase-config.js"></script>
    <script src="auth-check.js"></script>
    <script src="confirmation-dialog.js"></script>
    <script src="load-sidebar.js"></script>
    <script src="search.js"></script>
    <script src="form-validation.js"></script>
    <script src="keyboard-shortcuts.js"></script>
</head>

<body>
<!-- Sidebar will be loaded dynamically by load-sidebar.js -->
<main class="main-content" role="main">
    <p class="page-heading">Help & Support</p>
    <div style="margin-bottom: 1.125rem;"></div>

    <div style="width: 100%; padding: 0 1.125rem; margin-top: 2rem;">

        <!-- Keyboard Shortcuts Section -->
        <div style="background: white; border-radius: 0.5rem; box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05); border: 1px solid #e5e7eb; margin-bottom: 1.125rem; width: 100%; max-width: 800px; margin-left: auto; margin-right: auto;">
            <!-- Header -->
            <div style="padding: 1.5rem 1.5rem 0 1.5rem;">
                <h2 style="font-size: 1.5rem; font-weight: 700; color: #111827; margin: 0 0 1.5rem 0; font-family: 'Poppins', sans-serif;">Keyboard shortcuts</h2>
                </div>

            <!-- Tabs -->
            <div style="display: flex; gap: 0; border-bottom: 1px solid #e5e7eb; padding: 0 1.5rem;">
                <button 
                    id="globalTab" 
                    class="shortcut-tab active"
                    onclick="switchShortcutTab('global')"
                    onmouseover="if(!this.classList.contains('active')) { this.style.backgroundColor='#f3f4f6'; }"
                    onmouseout="if(!this.classList.contains('active')) { this.style.backgroundColor='transparent'; }"
                    style="padding: 0.75rem 1.25rem; background: #e0f2fe; border: none; border-bottom: 2px solid #0284c7; color: #0c4a6e; font-weight: 500; font-family: 'Poppins', sans-serif; font-size: 0.875rem; cursor: pointer; transition: all 0.2s; border-radius: 0.375rem 0.375rem 0 0; margin-bottom: -1px;">
                    Global
                </button>
                <button 
                    id="pageTab" 
                    class="shortcut-tab"
                    onclick="switchShortcutTab('page')"
                    onmouseover="if(!this.classList.contains('active')) { this.style.backgroundColor='#f3f4f6'; }"
                    onmouseout="if(!this.classList.contains('active')) { this.style.backgroundColor='transparent'; }"
                    style="padding: 0.75rem 1.25rem; background: transparent; border: none; border-bottom: 1px solid transparent; color: #6b7280; font-weight: 500; font-family: 'Poppins', sans-serif; font-size: 0.875rem; cursor: pointer; transition: all 0.2s; border-radius: 0.375rem 0.375rem 0 0; margin-bottom: -1px;">
                    Page-Specific
                </button>
            </div>

            <!-- Content -->
            <div style="padding: 1.5rem;">
                <!-- Global Shortcuts Content -->
                <div id="globalShortcutsContent" class="shortcut-content">
                    <div style="display: flex; flex-direction: column; gap: 0.5rem;" id="globalShortcuts">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>

                <!-- Page-Specific Shortcuts Content -->
                <div id="pageShortcutsContent" class="shortcut-content" style="display: none;">
                    <div style="display: flex; flex-direction: column; gap: 0.5rem;" id="pageShortcutsList">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>

<script>
// Populate keyboard shortcuts
document.addEventListener('DOMContentLoaded', function() {
    populateKeyboardShortcuts();
});

// Tab switching function
function switchShortcutTab(tab) {
    const globalTab = document.getElementById('globalTab');
    const pageTab = document.getElementById('pageTab');
    const globalContent = document.getElementById('globalShortcutsContent');
    const pageContent = document.getElementById('pageShortcutsContent');

    if (tab === 'global') {
        globalTab.classList.add('active');
        globalTab.style.background = '#e0f2fe';
        globalTab.style.borderBottom = '2px solid #0284c7';
        globalTab.style.color = '#0c4a6e';
        pageTab.classList.remove('active');
        pageTab.style.background = 'transparent';
        pageTab.style.borderBottom = '1px solid transparent';
        pageTab.style.color = '#6b7280';
        globalContent.style.display = 'block';
        pageContent.style.display = 'none';
    } else {
        pageTab.classList.add('active');
        pageTab.style.background = '#e0f2fe';
        pageTab.style.borderBottom = '2px solid #0284c7';
        pageTab.style.color = '#0c4a6e';
        globalTab.classList.remove('active');
        globalTab.style.background = 'transparent';
        globalTab.style.borderBottom = '1px solid transparent';
        globalTab.style.color = '#6b7280';
        pageContent.style.display = 'block';
        globalContent.style.display = 'none';
    }
}

// Get icon for shortcut based on description
function getShortcutIcon(description) {
    const desc = description.toLowerCase();
    if (desc.includes('search')) {
        return `<svg style="width: 1.25rem; height: 1.25rem; color: #6b7280;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
        </svg>`;
    } else if (desc.includes('create') || desc.includes('new')) {
        return `<svg style="width: 1.25rem; height: 1.25rem; color: #6b7280;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
        </svg>`;
    } else if (desc.includes('home')) {
        return `<svg style="width: 1.25rem; height: 1.25rem; color: #6b7280;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/>
        </svg>`;
    } else if (desc.includes('settings')) {
        return `<svg style="width: 1.25rem; height: 1.25rem; color: #6b7280;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/>
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
        </svg>`;
    } else if (desc.includes('sidebar')) {
        return `<svg style="width: 1.25rem; height: 1.25rem; color: #6b7280;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
        </svg>`;
    } else if (desc.includes('shortcut') || desc.includes('help')) {
        return `<svg style="width: 1.25rem; height: 1.25rem; color: #6b7280;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
        </svg>`;
    } else if (desc.includes('save') || desc.includes('submit')) {
        return `<svg style="width: 1.25rem; height: 1.25rem; color: #6b7280;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"/>
        </svg>`;
    } else if (desc.includes('edit')) {
        return `<svg style="width: 1.25rem; height: 1.25rem; color: #6b7280;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
        </svg>`;
    } else if (desc.includes('print')) {
        return `<svg style="width: 1.25rem; height: 1.25rem; color: #6b7280;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"/>
        </svg>`;
    } else if (desc.includes('reversal')) {
        return `<svg style="width: 1.25rem; height: 1.25rem; color: #6b7280;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
        </svg>`;
    } else if (desc.includes('focus')) {
        return `<svg style="width: 1.25rem; height: 1.25rem; color: #6b7280;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 15l-2 5L9 9l11 4-5 2zm0 0l5 5M7.188 2.239l.777 2.897M5.136 7.965l-2.898-.777M13.95 4.05l-2.122 2.122m-5.657 5.656l-2.12 2.122"/>
        </svg>`;
    }
    // Default icon
    return `<svg style="width: 1.25rem; height: 1.25rem; color: #6b7280;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"/>
    </svg>`;
}

// Format shortcut key for display
function formatShortcutKey(key) {
    const parts = key.split('+');
    const formatted = parts.map(part => {
        if (part === 'mod') {
            return navigator.platform.includes('Mac') ? 'âŒ˜' : 'Ctrl';
        }
        if (part === 'alt') return 'Alt';
        if (part === 'shift') return 'Shift';
        if (part === 'slash') return '/';
        if (part === 'question') return '?';
        if (part === 'comma') return ',';
        if (part === 'space') return 'Space';
        if (part === 'enter') return 'Enter';
        if (part === 'escape') return 'Esc';
        // Capitalize first letter
        return part.charAt(0).toUpperCase() + part.slice(1);
    });
    // Join with space for better readability
    return formatted.join(' + ');
}

// Populate keyboard shortcuts
function populateKeyboardShortcuts() {
    if (!window.keyboardShortcuts) {
        // Wait a bit for keyboard shortcuts to initialize
        setTimeout(populateKeyboardShortcuts, 100);
        return;
    }

    const ks = window.keyboardShortcuts;
    
    // Get global shortcuts
    const globalShortcuts = ks.getGlobalShortcuts();
    const globalContainer = document.getElementById('globalShortcuts');
    
    globalShortcuts.forEach(({ key, description }) => {
        const shortcutDiv = document.createElement('div');
        shortcutDiv.style.cssText = 'display: flex; align-items: center; justify-content: space-between; padding: 0.75rem 1rem; background: transparent; border-radius: 0.375rem; transition: all 0.2s; cursor: default;';
        shortcutDiv.onmouseover = () => shortcutDiv.style.backgroundColor = '#f9fafb';
        shortcutDiv.onmouseout = () => shortcutDiv.style.backgroundColor = 'transparent';
        
        const leftSection = document.createElement('div');
        leftSection.style.cssText = 'display: flex; align-items: center; gap: 0.75rem;';
        leftSection.innerHTML = `
            ${getShortcutIcon(description)}
            <span style="color: #374151; font-family: \'Poppins\', sans-serif; font-size: 0.875rem; font-weight: 400;">${description}</span>
        `;
        
        const rightSection = document.createElement('kbd');
        rightSection.style.cssText = 'padding: 0.25rem 0.5rem; background: white; border: 1px solid #e5e7eb; border-radius: 0.25rem; font-size: 0.75rem; font-weight: 500; color: #374151; font-family: \'Poppins\', sans-serif; box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);';
        rightSection.textContent = formatShortcutKey(key);
        
        shortcutDiv.appendChild(leftSection);
        shortcutDiv.appendChild(rightSection);
        globalContainer.appendChild(shortcutDiv);
    });

    // Get page-specific shortcuts
    const pageShortcuts = ks.getPageShortcuts();
        const pageContainer = document.getElementById('pageShortcutsList');
        
    if (pageShortcuts && pageShortcuts.length > 0) {
        pageShortcuts.forEach(({ key, description }) => {
            const shortcutDiv = document.createElement('div');
            shortcutDiv.style.cssText = 'display: flex; align-items: center; justify-content: space-between; padding: 0.75rem 1rem; background: transparent; border-radius: 0.375rem; transition: all 0.2s; cursor: default;';
            shortcutDiv.onmouseover = () => shortcutDiv.style.backgroundColor = '#f9fafb';
            shortcutDiv.onmouseout = () => shortcutDiv.style.backgroundColor = 'transparent';
            
            const leftSection = document.createElement('div');
            leftSection.style.cssText = 'display: flex; align-items: center; gap: 0.75rem;';
            leftSection.innerHTML = `
                ${getShortcutIcon(description)}
                <span style="color: #374151; font-family: \'Poppins\', sans-serif; font-size: 0.875rem; font-weight: 400;">${description}</span>
            `;
            
            const rightSection = document.createElement('kbd');
            rightSection.style.cssText = 'padding: 0.25rem 0.5rem; background: white; border: 1px solid #e5e7eb; border-radius: 0.25rem; font-size: 0.75rem; font-weight: 500; color: #374151; font-family: \'Poppins\', sans-serif; box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);';
            rightSection.textContent = formatShortcutKey(key);
            
            shortcutDiv.appendChild(leftSection);
            shortcutDiv.appendChild(rightSection);
            pageContainer.appendChild(shortcutDiv);
        });
    } else {
        // Show message if no page-specific shortcuts
        const noShortcutsMsg = document.createElement('div');
        noShortcutsMsg.style.cssText = 'padding: 2rem; text-align: center; color: #6b7280; font-family: \'Poppins\', sans-serif; font-size: 0.875rem;';
        noShortcutsMsg.textContent = 'No page-specific shortcuts available for this page.';
        pageContainer.appendChild(noShortcutsMsg);
    }
}
</script>
</body>
</html>

